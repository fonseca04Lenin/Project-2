<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Watchlist Pro</title>
    <!-- Cache busting: v2.1 - Fix multiple auth listeners causing slowdowns -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="static/css/style.css?v=2.0">
    
    <!-- Firebase SDK v9 with Compat Mode (Most reliable) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="firebase-config.js"></script>
</head>
<body>
    <div id="app">
        <!-- Notification Container -->
        <div id="notificationContainer" class="notification-container"></div>
        
        <!-- Modern Landing Page -->
        <div class="landing-page">
            <!-- Navigation -->
            <nav class="navbar">
                <div class="nav-container">
                    <div class="nav-brand">
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M3 13h2l2-7 4 12 4-9 2 2h4v-2h-3l-1-1-3 7-4-12-4 9H3z"/>
                        </svg>
                        <span class="brand-text">Watchlist Pro</span>
                    </div>
                </div>
            </nav>

            <!-- Hero Section -->
            <div class="hero-section">
                <div class="hero-container">
                    <!-- Left Side: Content -->
                    <div class="hero-content">
                        <!-- Premium animated background -->
                        <div class="premium-background">
                            <svg class="animated-lines" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
                                <!-- Network nodes -->
                                <circle cx="100" cy="150" r="4" class="network-node node-1" />
                                <circle cx="300" cy="100" r="3" class="network-node node-2" />
                                <circle cx="500" cy="200" r="5" class="network-node node-3" />
                                <circle cx="200" cy="350" r="3" class="network-node node-4" />
                                <circle cx="600" cy="300" r="4" class="network-node node-5" />
                                <circle cx="400" cy="450" r="3" class="network-node node-6" />
                                <circle cx="700" cy="180" r="4" class="network-node node-7" />
                                
                                <!-- Animated connecting lines -->
                                <path d="M100,150 Q200,125 300,100" class="network-line line-1" fill="none" />
                                <path d="M300,100 Q400,150 500,200" class="network-line line-2" fill="none" />
                                <path d="M100,150 Q150,250 200,350" class="network-line line-3" fill="none" />
                                <path d="M200,350 Q300,400 400,450" class="network-line line-4" fill="none" />
                                <path d="M500,200 Q550,250 600,300" class="network-line line-5" fill="none" />
                                <path d="M500,200 Q600,190 700,180" class="network-line line-6" fill="none" />
                                <path d="M300,100 Q500,140 700,180" class="network-line line-7" fill="none" />
                            </svg>
                            
                            <!-- Floating gradient orbs -->
                            <div class="gradient-orb orb-1"></div>
                            <div class="gradient-orb orb-2"></div>
                            <div class="gradient-orb orb-3"></div>
                        </div>
                        
                        <h1 class="hero-title premium-title">
                            Track Your Stocks
                            <span class="title-highlight">Like a Pro</span>
                            <div class="premium-underline"></div>
                        </h1>
                        
                        <p class="hero-description">
                            Build your watchlist, get live prices, and stay on top of market movements. Simple tools for smart investing.
                        </p>


                        <!-- Key Features -->
                        <div class="key-features">
                            <div class="feature-point">
                                <div class="feature-icon">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>
                                    </svg>
                                </div>
                                <span>Live stock prices</span>
                            </div>
                            <div class="feature-point">
                                <div class="feature-icon">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>
                                    </svg>
                                </div>
                                <span>Personal watchlist</span>
                            </div>
                            <div class="feature-point">
                                <div class="feature-icon">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>
                                    </svg>
                                </div>
                                <span>Market news & insights</span>
                            </div>
                        </div>

                        <!-- Social Proof -->
                        <div class="social-proof">
                            <div class="proof-item floating-badge">
                                <div class="proof-number pulse-number">5,000+</div>
                                <div class="proof-label">Stocks Tracked</div>
                            </div>
                            <div class="proof-item floating-badge" style="animation-delay: 0.5s;">
                                <div class="proof-number pulse-number">24/7</div>
                                <div class="proof-label">Market Data</div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Side: Authentication -->
                    <div class="auth-section">
                        <div class="auth-card premium-card">
                            <div class="auth-header">
                                <h2 class="auth-title">Start Tracking</h2>
                                <p class="auth-subtitle">Create your account to get started</p>
                            </div>

                            <div id="auth-container" class="auth-tabs-container">
                                <!-- Modern Tab Navigation -->
                                <div class="tab-navigation">
                                    <button id="login-tab" class="tab-btn active">
                                        Sign In
                                    </button>
                                    <button id="register-tab" class="tab-btn">
                                        Create Account
                                    </button>
                                </div>

                                <!-- Login Form -->
                                <div id="login-form" class="auth-form-container active">
                                    <form id="login-form-element" class="modern-form">
                                        <div class="input-field">
                                            <label for="login-email" class="input-label">Email address</label>
                                            <input 
                                                type="email" 
                                                id="login-email" 
                                                class="modern-input" 
                                                placeholder="Enter your email"
                                                required
                                            >
                                        </div>
                                        
                                        <div class="input-field">
                                            <label for="login-password" class="input-label">Password</label>
                                            <input 
                                                type="password" 
                                                id="login-password" 
                                                class="modern-input" 
                                                placeholder="Enter your password"
                                                required
                                            >
                                        </div>
                                        
                                        <div class="form-options">
                                            <label class="checkbox-container">
                                                <input type="checkbox" class="checkbox">
                                                <span class="checkmark"></span>
                                                <span class="checkbox-label">Remember me</span>
                                            </label>
                                            <a href="#forgot" class="forgot-link">Forgot password?</a>
                                        </div>
                                        
                                        <button type="submit" class="cta-button primary">
                                            <span class="btn-text">Sign In</span>
                                            <div class="btn-spinner" style="display: none;">
                                                <div class="spinner"></div>
                                            </div>
                                        </button>
                    </form>
                                </div>

                                <!-- Register Form -->
                                <div id="register-form" class="auth-form-container">
                                    <form id="register-form-element" class="modern-form">
                                        <div class="input-field">
                                            <label for="register-name" class="input-label">Full name</label>
                                            <input 
                                                type="text" 
                                                id="register-name" 
                                                class="modern-input" 
                                                placeholder="Enter your full name"
                                                required
                                            >
                                        </div>
                                        
                                        <div class="input-field">
                                            <label for="register-email" class="input-label">Email address</label>
                                            <input 
                                                type="email" 
                                                id="register-email" 
                                                class="modern-input" 
                                                placeholder="Enter your email"
                                                required
                                            >
                                        </div>
                                        
                                        <div class="input-field">
                                            <label for="register-password" class="input-label">Password</label>
                                            <input 
                                                type="password" 
                                                id="register-password" 
                                                class="modern-input" 
                                                placeholder="Create a strong password"
                                                required
                                            >
                                        </div>
                                        
                                        <div class="form-agreement">
                                            <label class="checkbox-container">
                                                <input type="checkbox" class="checkbox" required>
                                                <span class="checkmark"></span>
                                                <span class="checkbox-label">
                                                    I agree to the <a href="#terms" class="link">Terms of Service</a> and <a href="#privacy" class="link">Privacy Policy</a>
                                                </span>
                                            </label>
                </div>

                                        <button type="submit" class="cta-button primary">
                                            <span class="btn-text">Create Account</span>
                                            <div class="btn-spinner" style="display: none;">
                                                <div class="spinner"></div>
                                            </div>
                                        </button>
                    </form>
                                </div>
                            </div>

                            <!-- Trust Indicators -->
                            <div class="trust-bar">
                                <div class="trust-item">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"/>
                                    </svg>
                                    <span>Free to use</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Main App Content (hidden until authenticated) -->
        <div id="main-content" class="main-content" style="display: none;">
            <header class="modern-header">
                <div class="header-container">
                    <div class="header-left">
                        <div class="app-brand">
                            <i class="fas fa-chart-line brand-icon"></i>
                            <h1 class="brand-title">Watchlist Pro</h1>
                        </div>
                    </div>
                    
                    <div class="header-center">
                        <div class="market-status-display">
                            <span id="marketStatusIndicator" class="market-indicator">Loading...</span>
                        </div>
                    </div>
                    
                    <div class="header-right">
                        <div class="user-profile">
                            <div id="username-welcome" class="user-welcome">Welcome, User!</div>
                            <button onclick="handleLogout()" class="modern-logout-btn">
                                <i class="fas fa-sign-out-alt"></i>
                                <span>Logout</span>
                            </button>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Main Content -->
            <main class="main">
                <div class="container">
                    <!-- Search Section -->
                    <section class="search-section">
                        <div class="search-container">
                            <div class="search-box">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" id="searchInput" placeholder="Search stocks... (e.g., AAPL, Tesla, Microsoft)" class="search-input">
                                <button id="searchBtn" class="search-btn">
                                    <span class="btn-text">Search</span>
                                    <i class="fas fa-spinner fa-spin btn-loading" style="display: none;"></i>
                                </button>
                            </div>
                        </div>
                    </section>

                    <!-- Dashboard -->
                    <div class="dashboard">
                        <!-- Stock Results -->
                        <section class="stock-results" id="stockResults" style="display: none;">
                            <div class="stock-card" id="stockCard">
                                <!-- Stock data will be populated here -->
                            </div>
                        </section>

                        <!-- Content Grid -->
                        <div class="content-grid">
                            <!-- Watchlist Section -->
                            <section class="watchlist-section">
                                <div class="section-header">
                                    <h2>
                                        <i class="fas fa-star"></i>
                                        My Watchlist
                                    </h2>
                                    <button id="clearWatchlistBtn" class="clear-btn" title="Clear All">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                <div class="watchlist-container" id="watchlistContainer">
                                    <div class="empty-state" id="emptyWatchlist">
                                        <i class="fas fa-chart-line"></i>
                                        <p>Start building your portfolio</p>
                                        <small>Search for companies like Apple, Tesla, or Microsoft to add them to your watchlist</small>
                                    </div>
                                </div>
                            </section>

                            <!-- News Section -->
                            <section class="news-section">
                                <div class="section-header">
                                    <h2>
                                        <i class="fas fa-newspaper"></i>
                                        Market News
                                    </h2>
                                    <button id="refreshNewsBtn" class="refresh-btn" title="Refresh News">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                                <div class="news-container" id="newsContainer">
                                    <div class="loading-state">
                                        <i class="fas fa-spinner fa-spin"></i>
                                        <p>Loading news...</p>
                                    </div>
                                </div>
                            </section>

                            <!-- Chart Section -->
                            <section class="chart-section" id="chartSection" style="display: none;">
                                <div class="section-header">
                                    <h2>
                                        <i class="fas fa-chart-area"></i>
                                        Price Chart
                                        <span id="chartSelectedSymbol" class="chart-selected-symbol"></span>
                                    </h2>
                                    <button id="closeChartBtn" class="close-chart-btn" title="Close Chart" onclick="closeChartSection()">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                                <div class="chart-container">
                                    <canvas id="stockChart"></canvas>
                                </div>
                            </section>

                            <!-- Add Alerts Section -->
                            <div class="alerts-container">
                                <h2>Price Alerts</h2>
                                <div class="alerts-form">
                                    <input type="text" id="alert-symbol" placeholder="Stock Symbol">
                                    <input type="number" id="alert-price" placeholder="Target Price" step="0.01">
                                    <select id="alert-type">
                                        <option value="above">Price Above</option>
                                        <option value="below">Price Below</option>
                                    </select>
                                    <button onclick="createAlert()">Set Alert</button>
                                </div>
                                <div id="alerts-list"></div>
                            </div>

                            <!-- Market Intelligence Section -->
                            <div class="market-intelligence-container">
                                <h2>
                                    <i class="fas fa-brain"></i>
                                    Market Intelligence
                                </h2>
                                <div class="intelligence-tabs">
                                    <button class="tab-btn active" onclick="showIntelligenceTab('earnings')">Earnings Calendar</button>
                                    <button class="tab-btn" onclick="showIntelligenceTab('insider')">Insider Trading</button>
                                    <button class="tab-btn" onclick="showIntelligenceTab('analyst')">Analyst Ratings</button>
                                    <button class="tab-btn" onclick="showIntelligenceTab('options')">Options Data</button>
                                </div>
                                <div class="intelligence-content">
                                    <!-- Earnings Calendar Tab -->
                                    <div id="earnings-tab" class="tab-content active">
                                        <h3>Upcoming Earnings</h3>
                                        <div id="earningsList" class="earnings-list">
                                            <div class="loading-state">
                                                <i class="fas fa-spinner fa-spin"></i>
                                                <p>Loading earnings data...</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Insider Trading Tab -->
                                    <div id="insider-tab" class="tab-content">
                                        <h3>Insider Trading</h3>
                                        <div class="insider-search">
                                            <input type="text" id="insider-symbol" placeholder="Enter stock symbol">
                                            <button onclick="getInsiderTrading()">Search</button>
                                        </div>
                                        <div id="insiderList" class="insider-list">
                                            <div class="empty-state">
                                                <i class="fas fa-user-secret"></i>
                                                <p>Search for insider trading data</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Analyst Ratings Tab -->
                                    <div id="analyst-tab" class="tab-content">
                                        <h3>Analyst Ratings</h3>
                                        <div class="analyst-search">
                                            <input type="text" id="analyst-symbol" placeholder="Enter stock symbol">
                                            <button onclick="getAnalystRatings()">Search</button>
                                        </div>
                                        <div id="analystList" class="analyst-list">
                                            <div class="empty-state">
                                                <i class="fas fa-chart-bar"></i>
                                                <p>Search for analyst ratings</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Options Data Tab -->
                                    <div id="options-tab" class="tab-content">
                                        <h3>Options Data</h3>
                                        <div class="options-search">
                                            <input type="text" id="options-symbol" placeholder="Enter stock symbol">
                                            <button onclick="getOptionsData()">Search</button>
                                        </div>
                                        <div id="optionsList" class="options-list">
                                            <div class="empty-state">
                                                <i class="fas fa-chart-area"></i>
                                                <p>Search for options data</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- Modern Footer -->
            <footer class="modern-footer">
                <div class="footer-content">
                    <div class="footer-left">
                        <div class="app-info">
                            <i class="fas fa-chart-line footer-icon"></i>
                            <span class="footer-brand">Watchlist Pro</span>
                        </div>
                    </div>
                    
                    <div class="footer-center">
                        <div class="footer-stats">
                            <span class="stats-label">Real-time market data</span>
                        </div>
                    </div>
                    
                    <div class="footer-right">
                        <div class="user-info">
                            <span id="username-display" class="footer-username">User</span>
                        </div>
                    </div>
                </div>
            </footer>

            <!-- Toast Notifications -->
            <div id="toastContainer" class="toast-container"></div>
        </div>

        <!-- Stock Details Modal -->
        <div id="stockDetailsModal" class="stock-details-modal" style="display: none;">
          <div class="stock-details-content">
            <button class="close-details-btn close-details-btn-right" id="closeDetailsBtn" title="Close" onclick="closeStockDetailsModal()">
              <i class="fas fa-times"></i>
            </button>
            <div class="stock-details-header">
              <h2 id="detailsCompanyName">Company Name</h2>
              <span id="detailsSymbol" class="details-symbol"></span>
            </div>
            <div class="stock-details-meta">
              <div><strong data-icon="ceo">CEO:</strong> <span id="detailsCEO">-</span></div>
              <div><strong data-icon="desc">Description:</strong> <span id="detailsDescription">-</span></div>
              <div><strong data-icon="price">Price:</strong> $<span id="detailsPrice">-</span></div>
              <div><strong data-icon="marketcap">Market Cap:</strong> <span id="detailsMarketCap">-</span></div>
              <div><strong data-icon="pe">P/E Ratio:</strong> <span id="detailsPERatio">-</span></div>
              <div><strong data-icon="dividend">Dividend Yield:</strong> <span id="detailsDividendYield">-</span></div>
              <div><strong data-icon="website">Website:</strong> <a id="detailsWebsite" href="#" target="_blank" rel="noopener noreferrer">-</a></div>
              <div><strong data-icon="hq">Headquarters:</strong> <span id="detailsHeadquarters">-</span></div>
            </div>
            <div id="detailsChartContainer" class="chart-container" style="min-height: 300px;"></div>
            <div id="detailsNewsContainer" class="stock-details-news"></div>
            <button id="addToWatchlistBtn" class="add-to-watchlist-btn" style="display: none;">Add to Watchlist</button>
          </div>
        </div>
        <!-- End Stock Details Modal -->
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="config.js?v=2.2"></script>
    <script src="static/js/app.js?v=2.2"></script>
</body>
</html> 