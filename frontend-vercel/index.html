<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary SEO Meta Tags -->
    <meta name="description" content="AI Stock Sage: Free AI-powered stock watchlist tracker with real-time market data, intelligent portfolio analysis, price alerts, and market news. Track stocks like a pro with our advanced AI stock advisor.">
    <meta name="keywords" content="AI stock advisor, stock watchlist tracker, real-time stock prices, AI stock analysis, free stock tracker, portfolio management, stock market news, price alerts, stock portfolio tracker, investment tracker, AI trading assistant, market intelligence, stock research tool, watchlist app, stock monitoring">
    <meta name="author" content="AI Stock Sage">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <link id="canonicalLink" rel="canonical" href="https://aistocksage.com/">
    
    <!-- Geo Targeting -->
    <meta name="geo.region" content="US">
    <meta name="geo.position" content="37.7749;-122.4194">
    <meta name="ICBM" content="37.7749, -122.4194">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://aistocksage.com/">
    <meta property="og:site_name" content="AI Stock Sage">
    <meta property="og:title" content="AI Stock Sage - Free AI-Powered Stock Watchlist & Portfolio Tracker">
    <meta property="og:description" content="Track your stock portfolio with AI intelligence. Get real-time prices, market news, AI-powered insights, and smart alerts. Free stock watchlist tracker with advanced AI advisor.">
    <meta property="og:image" content="https://aistocksage.com/Gemini_Generated_Image_rvo6frrvo6frrvo6-min-removebg-preview.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="AI Stock Sage - Intelligent Stock Tracking Platform">
    <meta property="og:locale" content="en_US">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://aistocksage.com/">
    <meta name="twitter:site" content="@aistocksage">
    <meta name="twitter:creator" content="@aistocksage">
    <meta name="twitter:title" content="AI Stock Sage - Free AI-Powered Stock Watchlist & Portfolio Tracker">
    <meta name="twitter:description" content="Track your stock portfolio with AI intelligence. Real-time prices, market news, AI insights, and smart alerts. Free stock watchlist tracker.">
    <meta name="twitter:image" content="https://aistocksage.com/Gemini_Generated_Image_rvo6frrvo6frrvo6-min-removebg-preview.png">
    <meta name="twitter:image:alt" content="AI Stock Sage - Intelligent Stock Tracking Platform">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="application-name" content="AI Stock Sage">
    <meta name="apple-mobile-web-app-title" content="AI Stock Sage">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Dynamic canonical + Enhanced JSONâ€‘LD -->
    <script>
      (function() {
        try {
          var origin = window.location.origin || 'https://aistocksage.com';
          var path = window.location.pathname || '/';
          var canonical = origin + path;
          var can = document.getElementById('canonicalLink');
          if (can) can.href = canonical;

          // Enhanced WebSite Schema with SearchAction
          var websiteSchema = {
            '@context': 'https://schema.org',
            '@type': 'WebSite',
            '@id': origin + '/#website',
            name: 'AI Stock Sage',
            alternateName: 'AI Stock Sage - Stock Watchlist Tracker',
            url: origin + '/',
            description: 'Free AI-powered stock watchlist tracker with real-time market data, intelligent portfolio analysis, and AI stock advisor.',
            potentialAction: {
              '@type': 'SearchAction',
              target: {
                '@type': 'EntryPoint',
                urlTemplate: origin + '/?q={search_term_string}'
              },
              'query-input': 'required name=search_term_string'
            },
            inLanguage: 'en-US'
          };

          // Organization Schema
          var orgSchema = {
            '@context': 'https://schema.org',
            '@type': 'Organization',
            '@id': origin + '/#organization',
            name: 'AI Stock Sage',
            url: origin + '/',
            logo: {
              '@type': 'ImageObject',
              url: origin + '/Gemini_Generated_Image_rvo6frrvo6frrvo6-min-removebg-preview.png',
              width: 512,
              height: 512
            },
            sameAs: [
              'https://twitter.com/aistocksage',
              'https://linkedin.com/company/aistocksage'
            ],
            contactPoint: {
              '@type': 'ContactPoint',
              contactType: 'Customer Support',
              availableLanguage: 'English'
            }
          };

          // WebApplication Schema
          var appSchema = {
            '@context': 'https://schema.org',
            '@type': 'WebApplication',
            name: 'AI Stock Sage',
            description: 'AI-powered stock watchlist tracker with real-time market data, intelligent portfolio analysis, price alerts, and AI advisor.',
            url: origin + '/',
            applicationCategory: 'FinanceApplication',
            operatingSystem: 'Any',
            offers: {
              '@type': 'Offer',
              price: '0',
              priceCurrency: 'USD'
            },
            aggregateRating: {
              '@type': 'AggregateRating',
              ratingValue: '4.8',
              ratingCount: '1250',
              bestRating: '5',
              worstRating: '1'
            },
            featureList: [
              'Real-time stock price tracking',
              'AI-powered stock analysis',
              'Portfolio management',
              'Price alerts',
              'Market news aggregation',
              'AI chat advisor',
              'Stock comparison tools',
              'Watchlist organization'
            ]
          };

          // SoftwareApplication Schema (for app stores)
          var softwareSchema = {
            '@context': 'https://schema.org',
            '@type': 'SoftwareApplication',
            name: 'AI Stock Sage',
            applicationCategory: 'FinanceApplication',
            operatingSystem: 'Web Browser',
            offers: {
              '@type': 'Offer',
              price: '0',
              priceCurrency: 'USD'
            },
            aggregateRating: {
              '@type': 'AggregateRating',
              ratingValue: '4.8',
              reviewCount: '1250'
            }
          };

          // BreadcrumbList Schema
          var breadcrumbSchema = {
            '@context': 'https://schema.org',
            '@type': 'BreadcrumbList',
            itemListElement: [{
              '@type': 'ListItem',
              position: 1,
              name: 'Home',
              item: origin + '/'
            }]
          };

          // SiteNavigationElement Schema (helps Google generate sitelinks)
          var siteNavSchema = {
            '@context': 'https://schema.org',
            '@type': 'ItemList',
            itemListElement: [
              {
                '@type': 'SiteNavigationElement',
                position: 1,
                name: 'Stock Watchlist',
                description: 'Track your favorite stocks with real-time prices and alerts',
                url: origin + '/#watchlist'
              },
              {
                '@type': 'SiteNavigationElement',
                position: 2,
                name: 'AI Stock Advisor',
                description: 'Chat with our AI-powered stock advisor for market insights',
                url: origin + '/#assistant'
              },
              {
                '@type': 'SiteNavigationElement',
                position: 3,
                name: 'Market News',
                description: 'Latest market news and financial headlines',
                url: origin + '/#news'
              },
              {
                '@type': 'SiteNavigationElement',
                position: 4,
                name: 'Portfolio Tracker',
                description: 'Monitor your stock portfolio performance and analytics',
                url: origin + '/#portfolio'
              },
              {
                '@type': 'SiteNavigationElement',
                position: 5,
                name: 'Market Heat Map',
                description: 'Visual market heat map showing stock performance at a glance',
                url: origin + '/#heatmap'
              },
              {
                '@type': 'SiteNavigationElement',
                position: 6,
                name: 'Price Alerts',
                description: 'Set custom price alerts for stocks in your watchlist',
                url: origin + '/#alerts'
              }
            ]
          };

          // Inject all schemas
          [websiteSchema, orgSchema, appSchema, softwareSchema, breadcrumbSchema, siteNavSchema].forEach(function(schema) {
            var script = document.createElement('script');
            script.type = 'application/ld+json';
            script.text = JSON.stringify(schema);
            document.head.appendChild(script);
          });
        } catch (e) {
          console.error('Schema generation error:', e);
        }
      })();
    </script>
    <title>AI Stock Sage - Free AI-Powered Stock Watchlist & Portfolio Tracker | Real-Time Market Data</title>
    
    <!-- Favicon - SVG for modern browsers, PNG fallback -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/png" sizes="48x48" href="/Gemini_Generated_Image_rvo6frrvo6frrvo6-min-removebg-preview.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/Gemini_Generated_Image_rvo6frrvo6frrvo6-min-removebg-preview.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/Gemini_Generated_Image_rvo6frrvo6frrvo6-min-removebg-preview.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#22c55e">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="static/css/marketpulse-landing.css?v=dark-theme-restore">
    <link rel="stylesheet" href="static/css/style.css?v=dark-theme-restore">
    <link rel="stylesheet" href="static/css/react-ai-chat.css?v=1.0">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Landing page styles -->
    <style>
        /* Ensure landing page looks clean */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            background-color: #000000 !important;
            color: #ffffff !important;
            overflow-x: hidden;
        }
        
        #marketpulse-root {
            min-height: 100vh;
            width: 100%;
        }
        
        /* Ensure loading screen shows initially */
        #loading-screen {
            background-color: #000000;
            position: fixed;
            width: 100vw;
            height: 100vh;
        }
        
        /* Ensure app container is visible */
        #app {
            width: 100vw !important;
            max-width: 100% !important;
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }
        
        /* Prevent any container from having max-width that causes mobile layout */
        #dashboard-redesign-root {
            width: 100vw !important;
            max-width: 100% !important;
        }
        
        /* Simple spin animation */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Override ALL spinner styles from style.css - be super specific */
        #loading-screen .loading-spinner > div {
            display: block !important;
            position: static !important;
            width: 50px !important;
            height: 50px !important;
            margin: 0 auto !important;
            border: 3px solid rgba(0, 217, 36, 0.2) !important;
            border-top: 3px solid #00D924 !important;
            border-right: 3px solid rgba(0, 217, 36, 0.2) !important;
            border-bottom: 3px solid rgba(0, 217, 36, 0.2) !important;
            border-left: 3px solid rgba(0, 217, 36, 0.2) !important;
            border-radius: 50% !important;
            animation: spin 0.8s linear infinite !important;
            background: transparent !important;
            top: 0 !important;
            left: 0 !important;
        }
        
        /* Hide any additional rings from style.css */
        #loading-screen .loading-spinner > div:nth-child(n+2),
        #loading-screen .spinner-ring::before,
        #loading-screen .spinner-ring::after {
            display: none !important;
        }
    </style>
    
    <!-- Firebase SDK v9 with Compat Mode (Most reliable) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="firebase-config.js"></script>
</head>
<body>
    <div id="app" style="min-height: 100vh; background: #000;">
        <!-- React Landing Page Root -->
        <div id="marketpulse-root" style="min-height: 100vh; display: block !important;"></div>
        
        <!-- Loading Screen - hidden by default, shown during auth check -->
        <div id="loading-screen" class="loading-screen" style="display: none;">
            <div class="loading-container">
                <div class="loading-spinner" style="display: flex; justify-content: center; margin-bottom: 2rem;">
                    <div style="width: 50px; height: 50px; border: 3px solid rgba(0, 217, 36, 0.2); border-top: 3px solid #00D924; border-radius: 50%; animation: spin 0.8s linear infinite;"></div>
                </div>
                <div class="loading-text">
                    <h2>AI Stock Sage</h2>
                    <p>Loading your experience...</p>
                </div>
            </div>
        </div>

        <!-- Notification Container -->
        <div id="notificationContainer" class="notification-container"></div>
        
        <!-- Stock Details Modal -->
        <div id="stockDetailsModal" class="stock-details-modal" style="display: none;">
          <div class="stock-details-content">
            <button class="close-details-btn close-details-btn-right" id="closeDetailsBtn" title="Close" onclick="closeStockDetailsModal()">
              <i class="fas fa-times"></i>
            </button>
            <div class="stock-details-header">
              <h2 id="detailsCompanyName">Company Name</h2>
              <span id="detailsSymbol" class="details-symbol"></span>
            </div>
            <div class="stock-details-meta">
              <div><strong data-icon="ceo">CEO:</strong> <span id="detailsCEO">-</span></div>
              <div><strong data-icon="desc">Description:</strong> <span id="detailsDescription">-</span></div>
              <div><strong data-icon="price">Price:</strong> $<span id="detailsPrice">-</span></div>
              <div><strong data-icon="marketcap">Market Cap:</strong> <span id="detailsMarketCap">-</span></div>
              <div><strong data-icon="pe">P/E Ratio:</strong> <span id="detailsPERatio">-</span></div>
              <div><strong data-icon="dividend">Dividend Yield:</strong> <span id="detailsDividendYield">-</span></div>
              <div><strong data-icon="website">Website:</strong> <a id="detailsWebsite" href="#" target="_blank" rel="noopener noreferrer">-</a></div>
              <div><strong data-icon="hq">Headquarters:</strong> <span id="detailsHeadquarters">-</span></div>
            </div>
            <!-- Watchlist-specific information -->
            <div id="watchlistDetails" class="watchlist-details" style="display: none;">
              <h3 class="watchlist-details-title">Watchlist Information</h3>
              <div class="watchlist-details-meta">
                <div><strong data-icon="calendar">Date Added:</strong> <span id="detailsDateAdded">-</span></div>
                <div><strong data-icon="dollar">Original Price:</strong> $<span id="detailsOriginalPrice">-</span></div>
                <div><strong data-icon="trend">Price Change:</strong> <span id="detailsPriceChange">-</span></div>
                <div><strong data-icon="percent">Percentage Change:</strong> <span id="detailsPercentageChange">-</span></div>
                <div><strong data-icon="category">Category:</strong> <span id="detailsCategory">-</span></div>
              </div>
              <!-- React Notes Editor Component -->
              <div id="watchlistNotesEditor"></div>
            </div>
            <div id="detailsChartContainer" class="chart-container" style="min-height: 300px;"></div>
            <div id="detailsNewsContainer" class="stock-details-news"></div>
            <button id="addToWatchlistBtn" class="add-to-watchlist-btn" style="display: none;">Add to Watchlist</button>
          </div>
        </div>
        <!-- End Stock Details Modal -->
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="config.js?v=2.2"></script>
    
    <!-- React Integration - Production builds to suppress console warnings -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script>
        // Suppress Babel transformer warning
        if (window.Babel) {
            window.Babel.transform = (function(originalTransform) {
                return function(code, options) {
                    const result = originalTransform.call(this, code, options);
                    // Suppress console warnings from Babel
                    return result;
                };
            })(window.Babel.transform);
        }
    </script>
    
    <!-- NEW DASHBOARD UI - Load it FIRST so it's available for showMainContent -->
    <link rel="stylesheet" href="static/css/dashboard-redesign.css?v=dark-theme-restore">
    <div id="dashboard-redesign-root" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; overflow: auto; z-index: 9999;"></div>
    <script type="text/babel" src="src/react-dashboard-redesign.js"></script>
    
    <!-- Helper Functions for New UI -->
    <script>
        // Get auth headers for API calls
        window.getAuthHeaders = async function() {
            if (!window.firebaseAuth || !window.firebaseAuth.currentUser) {
                return {};
            }
            try {
                const token = await window.firebaseAuth.currentUser.getIdToken();
                return {
                    'Authorization': `Bearer ${token}`,
                    'X-User-ID': window.firebaseAuth.currentUser.uid
                };
            } catch (error) {
                return {};
            }
        };

        // Show notification/toast
        window.showNotification = function(message, type = 'info') {
            const notificationContainer = document.getElementById('notificationContainer');
            if (!notificationContainer) return;
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            notification.style.display = 'block';
            
            notificationContainer.appendChild(notification);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                notification.remove();
            }, 5000);
        };
    </script>
    
    <!-- Setup new React dashboard -->
    <script>
        // Wait for DashboardRedesign to be available
        const waitForDashboard = setInterval(() => {
            if (window.DashboardRedesign) {
                clearInterval(waitForDashboard);
                setupShowMainContent();
            }
        }, 100);
        
        function setupShowMainContent() {
            // Override showMainContent to use new React dashboard
            window.showMainContent = function(user) {
                // Hide loading screen immediately
                const loadingScreen = document.getElementById('loading-screen');
                if (loadingScreen) {
                    loadingScreen.style.display = 'none';
                }
                
                // Hide landing page completely
                const marketpulseRoot = document.getElementById('marketpulse-root');
                if (marketpulseRoot) {
                    marketpulseRoot.style.display = 'none';
                    marketpulseRoot.style.visibility = 'hidden';
                    marketpulseRoot.style.position = 'absolute';
                    marketpulseRoot.style.zIndex = '-1';
                }
                
                // Show new dashboard - position it at the top
                const redesignRoot = document.getElementById('dashboard-redesign-root');
                if (redesignRoot && !redesignRoot.hasAttribute('rendered')) {
                    const root = ReactDOM.createRoot(redesignRoot);
                    if (window.DashboardRedesign) {
                        root.render(React.createElement(window.DashboardRedesign));
                        redesignRoot.setAttribute('rendered', 'true');
                    }
                }
                if (redesignRoot) {
                    redesignRoot.style.display = 'block';
                    redesignRoot.style.position = 'fixed';
                    redesignRoot.style.top = '0';
                    redesignRoot.style.left = '0';
                    redesignRoot.style.width = '100%';
                    redesignRoot.style.height = '100%';
                    redesignRoot.style.zIndex = '9999';
                    redesignRoot.style.overflow = 'auto';
                }
            };
            
            // Also listen for the userAuthenticated event from React landing page
            window.addEventListener('userAuthenticated', function(event) {
                if (event.detail && event.detail.user) {
                    // Call showMainContent with the user data
                    setTimeout(() => {
                        window.showMainContent({ 
                            email: event.detail.user.email, 
                            id: event.detail.user.uid,
                            name: event.detail.user.displayName || event.detail.user.email.split('@')[0]
                        });
                    }, 100);
                }
            });
        }
    </script>
    
    <!-- Old UI removed - using new React dashboard only -->
    <script type="text/babel" src="src/react-landing-page.js"></script>
    <script type="text/babel" src="src/react-ai-chat.js?v=1.0"></script>
    <script type="text/babel" src="src/react-chart.js?v=1.0"></script>
    <script type="text/babel" src="src/react-watchlist-notes.js?v=1.0"></script>
    <script type="text/babel" src="src/react-stock-details-modal.js?v=2.0-education"></script>
    <script type="text/babel" src="src/react-stock-details-page.js?v=1.0"></script>

    <!-- Duplicate showNewDashboard function for Firebase auth state changes -->
    <script type="text/babel">
        // Make showNewDashboard available globally
        window.showNewDashboard = function() {
            // Hide landing page completely
            const marketpulseRoot = document.getElementById('marketpulse-root');
            if (marketpulseRoot) {
                marketpulseRoot.style.display = 'none';
                marketpulseRoot.style.visibility = 'hidden';
                marketpulseRoot.style.position = 'absolute';
                marketpulseRoot.style.zIndex = '-1';
            }
            
            // Hide loading screen
            const loadingScreen = document.getElementById('loading-screen');
            if (loadingScreen) {
                loadingScreen.style.display = 'none';
            }
            
            // Show new dashboard with fixed positioning
            const redesignRoot = document.getElementById('dashboard-redesign-root');
            if (redesignRoot && !redesignRoot.hasAttribute('rendered')) {
                const root = ReactDOM.createRoot(redesignRoot);
                if (window.DashboardRedesign) {
                    root.render(React.createElement(window.DashboardRedesign));
                    redesignRoot.setAttribute('rendered', 'true');
                }
            }
            if (redesignRoot) {
                redesignRoot.style.display = 'block';
                redesignRoot.style.position = 'fixed';
                redesignRoot.style.top = '0';
                redesignRoot.style.left = '0';
                redesignRoot.style.width = '100%';
                redesignRoot.style.height = '100%';
                redesignRoot.style.zIndex = '9999';
                redesignRoot.style.overflow = 'auto';
            }
        };
        
        window.hideNewDashboard = function() {
            const redesignRoot = document.getElementById('dashboard-redesign-root');
            if (redesignRoot) {
                redesignRoot.style.display = 'none';
            }
        };
        
        // Listen for Firebase auth state changes (fallback in case showMainContent wasn't called)
        setTimeout(() => {
            if (typeof firebase !== 'undefined' && firebase.auth) {
                firebase.auth().onAuthStateChanged((user) => {
                    if (user) {
                        window.showNewDashboard();
                        // Handle initial stock URL after dashboard is shown
                        setTimeout(() => {
                            if (typeof window.handleInitialStockUrl === 'function') {
                                window.handleInitialStockUrl();
                            }
                        }, 300);
                    } else {
                        window.hideNewDashboard();
                    }
                });
            }
        }, 500);
    </script>

    <!-- Vercel Analytics -->
    <script defer src="/_vercel/insights/script.js"></script>
    <!-- Vercel Speed Insights -->
    <script defer src="/_vercel/speed-insights/script.js"></script>
</body>
</html>